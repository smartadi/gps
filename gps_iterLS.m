clear all;
close all;
clc;

mu = 1;
a  = 1;
c = 1000;

S = [10000, 0, 0;
    0, 10000, 0;
    0, 0, 10000;
    10000, 10000, 10000];


S2 = [1000, 0, 0;
    0, 1000, 0;
    0, 0, 1000;
    1000, 1000, 1000;
    1000, 1000, 0;
    0, 1000, 1000;
    1000, 0, 1000;
    -1000, -1000, -1000];
xt = [1000,1000,1000];

t = vecnorm(S-xt,2,2)/c + [0;0.1;0;0];

% t = [ 9;
%     10;
%     10;
%     17.3205];

t2 = [ 1;
    1;
    1;
    1.73;
    1.4142;
    1.4142;
    1.4142;
    1.732];


x0 = [0;
    0;
    0];
x02 = [10;
    10;
    10];


rho = t*c;

rho2 = t2*c;

for i=1:1
S-x0';
dp = vecnorm(S - x0',2,2) - c*t 

% dp2 = vecnorm(S2 - x02',2,2) - c*t2; 

A = [(x0(1)-S(1,1))/rho(1),(x0(2)-S(1,2))/rho(1),(x0(3)-S(1,3))/rho(1),c;
     (x0(1)-S(2,1))/rho(2),(x0(2)-S(2,2))/rho(2),(x0(3)-S(2,3))/rho(2),c;
     (x0(1)-S(3,1))/rho(3),(x0(2)-S(3,2))/rho(3),(x0(3)-S(3,3))/rho(3),c;
     (x0(1)-S(4,1))/rho(4),(x0(2)-S(4,2))/rho(4),(x0(3)-S(4,3))/rho(4),c];

A2 = [(x0(1)-S2(1,1))/rho2(1),(x0(2)-S2(1,2))/rho2(1),(x0(3)-S2(1,3))/rho2(1),c;
     (x0(1)-S2(2,1))/rho2(2),(x0(2)-S2(2,2))/rho2(2),(x0(3)-S2(2,3))/rho2(2),c;
     (x0(1)-S2(3,1))/rho2(3),(x0(2)-S2(3,2))/rho2(3),(x0(3)-S2(3,3))/rho2(3),c;
     (x0(1)-S2(4,1))/rho2(4),(x0(2)-S2(4,2))/rho2(4),(x0(3)-S2(4,3))/rho2(4),c;
     (x0(1)-S2(5,1))/rho2(5),(x0(2)-S2(5,2))/rho2(5),(x0(3)-S2(5,3))/rho2(5),c;
     (x0(1)-S2(6,1))/rho2(6),(x0(2)-S2(6,2))/rho2(6),(x0(3)-S2(6,3))/rho2(6),c;
     (x0(1)-S2(7,1))/rho2(7),(x0(2)-S2(7,2))/rho2(7),(x0(3)-S2(8,3))/rho2(7),c;
     (x0(1)-S2(8,1))/rho2(8),(x0(2)-S2(8,2))/rho2(8),(x0(3)-S2(8,3))/rho2(8),c];
 
 
dx = inv(A'*A)*A'*dp
% dx2 = inv(A2'*A2)*A2'*dp2;

x0 = x0-dx(1:3);
% x02 = x02-dx2(1:3);

end
C = inv(A'*A);
eigs(C)
sum(eig(C))



C2 = inv(A2'*A2);
eigs(C2)
sum(eig(C2))
x0
x02