clear all;
close all;
clc;

mu = 1;
a  = 1;
c = 1000;

S = [1000, 0, 0;
    0, 1000, 0;
    0, 0, 1000;
    1000, 1000, 1000];

t = [ 1.01;
    1.01;
    1.01;
    1.732];


x0 = [10;
    20;
    30];


rho = t*c;
for i=1:100
S-x0'
dp = vecnorm(S - x0',2,2) - c*t; 
A = [(x0(1)-S(1,1))/rho(1),(x0(2)-S(1,2))/rho(1),(x0(3)-S(1,3))/rho(1),c;
     (x0(1)-S(2,1))/rho(2),(x0(2)-S(2,2))/rho(2),(x0(3)-S(2,3))/rho(2),c;
     (x0(1)-S(3,1))/rho(3),(x0(2)-S(3,2))/rho(3),(x0(3)-S(3,3))/rho(3),c;
     (x0(1)-S(4,1))/rho(4),(x0(2)-S(4,2))/rho(4),(x0(3)-S(4,3))/rho(4),c];
 
dx = inv(A'*A)*A'*dp

x0 = x0-dx(1:3)

end